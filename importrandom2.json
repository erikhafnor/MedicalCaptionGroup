import random

import matplotlib.pyplot as plt

# Ensure you have the following variables:
# - images: List of all images in the dataset
# - captions: List of all original captions in the dataset
# - y_test: True labels for the test set
# - y_pred: Predicted labels from the RandomForestClassifier
# - X_test: Test features

# Select 10 random indices from the test set
random_indices = random.sample(range(len(X_test)), 10)

# Iterate over the selected indices
for idx in random_indices:
    # Get the original image, original caption, and predicted label
    original_image = images[idx]  # Assuming `images` contains the original image objects
    original_caption = captions[idx]
    predicted_label = y_pred[idx]

    # Retrieve the generated caption based on the predicted label
    # Assuming `captions` is a list where the index corresponds to the label
    generated_caption = captions[predicted_label]

    # Plot the image with captions
    plt.figure(figsize=(6, 6))
    plt.imshow(original_image)
    plt.axis("off")
    plt.title(f"Original: {original_caption}\nGenerated: {generated_caption}", fontsize=10)
    plt.show()